<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<script src="https://apis.google.com/js/platform.js" async defer></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
<body>
<div id="Username"></div>
<div id="Email"></div>
<div id="redirectMessage"></div>
</body>
</html>
<script>
    console.log(window.location.href);
    if (window.location.href ===
        "https://6998frontendtest.s3.amazonaws.com/cognitoRedirect.html#" +
        "error_description=PreSignUp+failed+with+error+Please_use_Email_of_Columbia_University_to_log_in." +
        "+&error=invalid_request") {
        document.getElementById('Username').innerHTML = "Please use your Columbia University Email to Log In!";
        document.getElementById('redirectMessage').innerHTML = "Redirecting you to the SignIn page in 5 seconds....";
        setTimeout(function () {
            // do log out to clear the cookie and sessions
            // https://docs.aws.amazon.com/cognito/latest/developerguide/logout-endpoint.html
            $.ajax({
                url: "https://mydomain.auth.us-east-1.amazoncognito.com/logout" + "?" + "client_id=" + ad398u21ijw3s9w3939 + "&"
                    + "redirect_uri=https://lionwalkonetwo.auth.us-east-1.amazoncognito.com/login?" +
                    "redirect_uri=https%3A%2F%2F6998frontendtest.s3.amazonaws.com%2FcognitoRedirect.html&" +
                    "response_type=token&client_id=uudop5ji4a930hd2ld8gio4qn",
                type: 'GET',
                cache: false,
                processData: false,
                contentType: 'application/json',
                success: function (r) {
                }
            })
            // window.location.assign("https://lionwalkonetwo.auth.us-east-1.amazoncognito.com/login?" +
            //     "redirect_uri=https%3A%2F%2F6998frontendtest.s3.amazonaws.com%2FcognitoRedirect.html&" +
            //     "response_type=token&client_id=uudop5ji4a930hd2ld8gio4qn");
        }, 5000);

    } else {
        var idToken = window.location.href.split("id_token=")[1].split("&")[0];
        var accessToken = window.location.href.split("access_token=")[1].split("&")[0];
        console.log(idToken);
        console.log("access:")
        console.log(accessToken);
        window.location.assign("https://6998frontendtest.s3.amazonaws.com/profile.html");
        // Session
        // localStorage.setItem("id_token",idToken);
        // console.log(localStorage.getItem("id_token"));
        // $.ajax({
        //     url: "https://k9wj046mrd.execute-api.us-east-1.amazonaws.com/6998FirstTry/login" + "?accessToken=" + accessToken,
        //     headers: {"Token": idToken},
        //     type: 'GET',
        //     cache: false,
        //     processData: false,
        //     contentType: 'application/json',
        //     success: function (r) {
        //         document.getElementById('Username').innerHTML = "Username: " + r.Username;
        //         document.getElementById('Email').innerHTML = "Email: " + r.Email;
        //         window.location.assign("https://6998frontendtest.s3.amazonaws.com/profile.html");
        //         console.log(r);
        //     }
        // })
    }

</script>